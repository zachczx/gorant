htmx.defineExtension("preload",{onEvent:function(e,t){if("htmx:afterProcessNode"!==e)return;var r=function(e,t){if(void 0!=e)return e.getAttribute(t)||e.getAttribute("data-"+t)||r(e.parentElement,t)},a=function(e){var t=function(t){e.preloadAlways||(e.preloadState="DONE"),"true"==r(e,"preload-images")&&(document.createElement("div").innerHTML=t)};return function(){if("READY"===e.preloadState){var r=e.getAttribute("hx-get")||e.getAttribute("data-hx-get");if(r){htmx.ajax("GET",r,{source:e,handler:function(e,r){t(r.xhr.responseText)}});return}if(e.getAttribute("href")){var a=new XMLHttpRequest;a.open("GET",e.getAttribute("href")),a.onload=function(){t(a.responseText)},a.send()}}}},n=function(e){if(e.getAttribute("href")+e.getAttribute("hx-get")+e.getAttribute("data-hx-get")==""||void 0!==e.preloadState)return;var t=r(e,"preload")||"mousedown";let n=-1!==t.indexOf("always");switch(n&&(t=t.replace("always","").trim()),e.addEventListener(t,function(r){"PAUSE"===e.preloadState&&(e.preloadState="READY","mouseover"===t?window.setTimeout(a(e),100):a(e)())}),t){case"mouseover":e.addEventListener("touchstart",a(e)),e.addEventListener("mouseout",function(t){t.target===e&&"READY"===e.preloadState&&(e.preloadState="PAUSE")});break;case"mousedown":e.addEventListener("touchstart",a(e))}e.preloadState="PAUSE",e.preloadAlways=n,htmx.trigger(e,"preload:init")};let o=t.target||t.detail.elt;o.querySelectorAll("[preload]").forEach(function(e){n(e),e.querySelectorAll("a,[hx-get],[data-hx-get]").forEach(n)})}});